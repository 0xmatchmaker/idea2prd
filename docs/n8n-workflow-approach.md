# n8n å·¥ä½œæµæ–¹æ¡ˆè°ƒç ”æŠ¥å‘Š

**åˆ›å»ºæ—¶é—´**: 2025-10-26
**è°ƒç ”ç›®æ ‡**: è¯„ä¼°ä½¿ç”¨ n8n èŠ‚ç‚¹å¯¹æ¯”æ›¿ä»£æ–‡æœ¬ diff çš„å¯è¡Œæ€§

---

## ä¸€ã€æ ¸å¿ƒå‘ç°

### 1.1 ä»€ä¹ˆæ˜¯ n8n-MCPï¼Ÿ

**n8n-MCP** æ˜¯ä¸€ä¸ª Model Context Protocol (MCP) æœåŠ¡å™¨ï¼Œä¸»è¦åŠŸèƒ½ï¼š
- è®© AI åŠ©æ‰‹èƒ½å¤Ÿæ„å»ºå’Œä¿®æ”¹ n8n å·¥ä½œæµ
- æ”¯æŒ 525+ n8n èŠ‚ç‚¹ï¼Œ99% å±æ€§è¦†ç›–
- å‡å°‘é…ç½®é”™è¯¯ï¼ŒåŠ é€Ÿå·¥ä½œæµåˆ›å»º
- å®˜ç½‘ï¼šhttps://www.n8n-mcp.com/
- GitHubï¼šhttps://github.com/nerding-io/n8n-nodes-mcp

**Model Context Protocol (MCP)**:
- Anthropic å¼€å‘çš„å¼€æºåè®®
- è®© AI ç³»ç»Ÿï¼ˆClaudeã€ChatGPTç­‰ï¼‰å®‰å…¨è¿æ¥å¤–éƒ¨æ•°æ®å’Œå·¥å…·
- å®¢æˆ·ç«¯-æœåŠ¡å™¨æ¶æ„

### 1.2 n8n å·¥ä½œæµæ ¼å¼

n8n ä½¿ç”¨ **JSON æ ¼å¼** ä¿å­˜å·¥ä½œæµï¼Œæ ¸å¿ƒç»“æ„ï¼š

```json
{
  "nodes": [
    {
      "id": "node-1",
      "type": "n8n-nodes-base.webhook",
      "name": "ç”¨æˆ·æ³¨å†Œè§¦å‘",
      "position": [250, 300],
      "parameters": { ... }
    },
    {
      "id": "node-2",
      "type": "n8n-nodes-base.function",
      "name": "éªŒè¯é‚®ç®±",
      "position": [450, 300],
      "parameters": { ... }
    }
  ],
  "connections": {
    "node-1": {
      "main": [[{ "node": "node-2", "type": "main", "index": 0 }]]
    }
  }
}
```

**å…³é”®å…ƒç´ **:
- `nodes`: èŠ‚ç‚¹æ•°ç»„ï¼ˆç±»å‹ã€åç§°ã€ä½ç½®ã€å‚æ•°ï¼‰
- `connections`: èŠ‚ç‚¹è¿æ¥å…³ç³»ï¼ˆæ•°æ®æµå‘ï¼‰

### 1.3 n8n å·²æœ‰çš„å¯¹æ¯”åŠŸèƒ½

âœ… **å†…ç½® Workflow Diff**:
- å‚ç›´å †å æ˜¾ç¤ºä¸¤ä¸ªç‰ˆæœ¬
- ğŸŸ¢ ç»¿è‰² + "N" = æ–°å¢èŠ‚ç‚¹/è¿æ¥
- ğŸŸ  æ©™è‰² + "M" = ä¿®æ”¹èŠ‚ç‚¹
- ğŸ”´ çº¢è‰² + "D" = åˆ é™¤èŠ‚ç‚¹
- JSON çº§åˆ«çš„è¯¦ç»† diff

âœ… **Workflow History**:
- ç‰ˆæœ¬å†å²ç®¡ç†
- æ¢å¤æ—§ç‰ˆæœ¬
- å…‹éš†åˆ°æ–°å·¥ä½œæµ
- å¹¶æ’å¯¹æ¯”ç‰ˆæœ¬

âœ… **ç¬¬ä¸‰æ–¹å·¥å…·**:
- `n8n-workflows-comparator` (GitHub)
- å·¥ä½œæµçº§åˆ«å¯¹æ¯”
- èŠ‚ç‚¹è¯¦ç»†åˆ†æ
- å¤šç§è¾“å‡ºæ ¼å¼ï¼ˆæ§åˆ¶å°ã€JSONï¼‰

### 1.4 å¯è§†åŒ–å·¥å…·

**N8N Viewer** (https://n8nviewer.com/):
- ä¸Šä¼  JSON å³å¯ç”Ÿæˆå¯è§†åŒ–æµç¨‹å›¾
- äº¤äº’å¼èŠ‚ç‚¹å›¾è¡¨
- æ— éœ€å®‰è£… n8n

---

## äºŒã€æ–¹æ¡ˆå¯¹æ¯”ï¼šæ–‡æœ¬ vs èŠ‚ç‚¹

| ç»´åº¦ | æ–‡æœ¬ PRDï¼ˆåŸæ–¹æ¡ˆï¼‰ | n8n å·¥ä½œæµï¼ˆæ–°æ–¹æ¡ˆï¼‰ | è¯„åˆ† |
|------|-------------------|---------------------|------|
| **æ˜“ç”¨æ€§** | éœ€è¦å†™æ–‡æ¡£ï¼ŒæŠ€æœ¯é—¨æ§›è¾ƒé«˜ | æ‹–æ‹½èŠ‚ç‚¹ï¼Œå¯è§†åŒ–æ“ä½œ | âœ… èŠ‚ç‚¹ +2 |
| **ç›´è§‚æ€§** | æ–‡å­—æè¿°ï¼Œéœ€è¦æƒ³è±¡ | æµç¨‹å›¾ï¼Œä¸€ç›®äº†ç„¶ | âœ… èŠ‚ç‚¹ +2 |
| **å¯æ‰§è¡Œæ€§** | é™æ€æ–‡æ¡£ï¼Œä¸å¯æ‰§è¡Œ | å¯ç›´æ¥è¿è¡Œæµ‹è¯• | âœ… èŠ‚ç‚¹ +2 |
| **å¯¹æ¯”æ•ˆæœ** | æ–‡æœ¬ diffï¼Œç»¿çº¢é«˜äº® | èŠ‚ç‚¹ diffï¼Œé¢œè‰²æ ‡è®° | âœ… èŠ‚ç‚¹ +1 |
| **é€‚ç”¨åœºæ™¯** | é€šç”¨ PRD æè¿° | æµç¨‹åŒ–ä¸šåŠ¡é€»è¾‘ | âš ï¸ æœ‰å±€é™ |
| **AI ç”Ÿæˆ** | ç”Ÿæˆæ–‡æœ¬å†…å®¹ | é€šè¿‡ n8n-MCP ç”Ÿæˆæµç¨‹ | âœ… èŠ‚ç‚¹ +2 |
| **å­¦ä¹ æˆæœ¬** | ä¼šå†™æ–‡æ¡£å³å¯ | éœ€è¦äº†è§£ n8n èŠ‚ç‚¹ | âš ï¸ æ–‡æœ¬ +1 |
| **çµæ´»æ€§** | å¯ä»¥æè¿°ä»»ä½•éœ€æ±‚ | å—èŠ‚ç‚¹ç±»å‹é™åˆ¶ | âš ï¸ æ–‡æœ¬ +1 |

**æ€»åˆ†**: èŠ‚ç‚¹æ–¹æ¡ˆ +9ï¼Œæ–‡æœ¬æ–¹æ¡ˆ +2

---

## ä¸‰ã€æ ¸å¿ƒä»·å€¼åˆ†æ

### 3.1 ä¸ºä»€ä¹ˆèŠ‚ç‚¹å¯¹æ¯”æ›´é€‚åˆï¼Ÿ

#### âœ… ä¼˜åŠ¿

1. **é™ä½è®¤çŸ¥é—¨æ§›**
   - ä¸éœ€è¦ä¼šå†™ä»£ç æˆ–æ–‡æ¡£
   - æ‹–æ‹½èŠ‚ç‚¹æ¯”å†™ PRD ç®€å•
   - æµç¨‹å›¾æ¯”æ–‡å­—æ›´å®¹æ˜“ç†è§£

2. **å¼ºåˆ¶ç»“æ„åŒ–æ€è€ƒ**
   - å¿…é¡»å®šä¹‰è¾“å…¥/è¾“å‡º
   - å¿…é¡»å®šä¹‰æµç¨‹èŠ‚ç‚¹
   - è‡ªåŠ¨å½¢æˆé€»è¾‘é—­ç¯

3. **å¯è§†åŒ–å¯¹æ¯”**
   - ä¸€çœ¼çœ‹å‡ºæ–°å¢äº†å“ªäº›æ­¥éª¤ï¼ˆç»¿è‰²ï¼‰
   - ä¿®æ”¹äº†å“ªäº›é€»è¾‘ï¼ˆæ©™è‰²ï¼‰
   - åˆ é™¤äº†å“ªäº›æµç¨‹ï¼ˆçº¢è‰²ï¼‰

4. **å¯æ‰§è¡ŒéªŒè¯**
   - æµç¨‹å›¾å¯ä»¥ç›´æ¥è¿è¡Œæµ‹è¯•
   - ç«‹å³å‘ç°é€»è¾‘é”™è¯¯
   - PRD å˜æˆå¯æ¼”ç¤ºçš„åŸå‹

5. **AI åŸç”Ÿæ”¯æŒ**
   - é€šè¿‡ n8n-MCPï¼ŒAI å¯ä»¥ç›´æ¥ç”Ÿæˆæµç¨‹å›¾
   - ä¸éœ€è¦æ‰‹åŠ¨è½¬æ¢
   - è¿­ä»£æ›´é«˜æ•ˆ

#### âš ï¸ å±€é™æ€§

1. **é€‚ç”¨èŒƒå›´å—é™**
   - é€‚åˆï¼šæµç¨‹åŒ–ã€é€»è¾‘åŒ–çš„éœ€æ±‚ï¼ˆè®¢å•ã€æ³¨å†Œã€æ•°æ®åŒæ­¥ï¼‰
   - ä¸é€‚åˆï¼šçº¯å±•ç¤ºç±»éœ€æ±‚ï¼ˆUI è®¾è®¡ã€è§†è§‰é£æ ¼ï¼‰

2. **å­¦ä¹ æ›²çº¿**
   - ç”¨æˆ·éœ€è¦äº†è§£ n8n èŠ‚ç‚¹ç±»å‹
   - éœ€è¦ç†è§£æ•°æ®æµæ¦‚å¿µ

3. **è¡¨è¾¾èƒ½åŠ›**
   - æŸäº›æŠ½è±¡éœ€æ±‚éš¾ä»¥ç”¨èŠ‚ç‚¹è¡¨è¾¾
   - éæŠ€æœ¯èƒŒæ™¯å’Œç»†èŠ‚æè¿°å—é™

---

## å››ã€åº”ç”¨åœºæ™¯ä¸¾ä¾‹

### 4.1 ç”¨æˆ·æ³¨å†Œæµç¨‹ï¼ˆå®Œç¾é€‚é…ï¼‰

**ä¼ ç»Ÿ PRD æ–‡æœ¬**:
```
ç”¨æˆ·ç‚¹å‡»æ³¨å†Œ â†’ å¡«å†™é‚®ç®±/å¯†ç  â†’ å‰ç«¯éªŒè¯ â†’ åç«¯éªŒè¯ â†’ åˆ›å»ºç”¨æˆ· â†’ å‘é€æ¬¢è¿é‚®ä»¶
```

**n8n å·¥ä½œæµèŠ‚ç‚¹**:
```
[Webhook è§¦å‘] â†’ [éªŒè¯é‚®ç®±æ ¼å¼] â†’ [æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å­˜åœ¨]
                                    â†“
                            [åˆ›å»º Supabase ç”¨æˆ·] â†’ [å‘é€é‚®ä»¶èŠ‚ç‚¹]
```

**ç‰ˆæœ¬å¯¹æ¯”ç¤ºä¾‹**:
- V1: åªæœ‰åŸºç¡€æ³¨å†Œ
- V2: ğŸŸ¢ æ–°å¢"å‘é€æ¬¢è¿é‚®ä»¶"èŠ‚ç‚¹
- V3: ğŸŸ  ä¿®æ”¹"éªŒè¯é€»è¾‘"èŠ‚ç‚¹ï¼ˆå¢åŠ å¯†ç å¼ºåº¦æ£€æŸ¥ï¼‰

### 4.2 è®¢å•å¤„ç†æµç¨‹ï¼ˆå®Œç¾é€‚é…ï¼‰

```
[è®¢å•åˆ›å»º] â†’ [åº“å­˜æ£€æŸ¥] â†’ [IF: åº“å­˜å……è¶³?]
                              â†“ Yes          â†“ No
                        [æ‰£å‡åº“å­˜]        [é€šçŸ¥è¡¥è´§]
                              â†“
                        [è°ƒç”¨æ”¯ä»˜]
                              â†“
                        [ç”Ÿæˆå‘è´§å•]
```

### 4.3 æ•°æ®åŒæ­¥æµç¨‹ï¼ˆå®Œç¾é€‚é…ï¼‰

```
[å®šæ—¶è§¦å‘] â†’ [HTTP è·å–æ•°æ®] â†’ [è½¬æ¢æ ¼å¼] â†’ [å†™å…¥ Supabase]
                                                â†“
                                        [Slack é€šçŸ¥å®Œæˆ]
```

### 4.4 ä¸é€‚åˆçš„åœºæ™¯

âŒ **UI/UX è®¾è®¡éœ€æ±‚**:
- "é¦–é¡µé‡‡ç”¨å¡ç‰‡å¼å¸ƒå±€" - éš¾ä»¥ç”¨èŠ‚ç‚¹è¡¨è¾¾

âŒ **è§†è§‰é£æ ¼æè¿°**:
- "å“ç‰Œè‰²ä¸ºè“è‰²ç³»ï¼Œåœ†è§’8px" - ä¸é€‚åˆèŠ‚ç‚¹

âŒ **æŠ½è±¡æˆ˜ç•¥è§„åˆ’**:
- "æå‡ç”¨æˆ·ç•™å­˜ç‡" - éœ€è¦æ–‡å­—æè¿°

---

## äº”ã€æŠ€æœ¯å®ç°æ–¹æ¡ˆ

### 5.1 æ¶æ„è®¾è®¡

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  ç”¨æˆ·ç•Œé¢                                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚  n8n ç¼–è¾‘å™¨      â”‚          â”‚  ç‰ˆæœ¬å¯¹æ¯”è§†å›¾           â”‚ â”‚
â”‚  â”‚  (åµŒå…¥æˆ–é›†æˆ)    â”‚          â”‚  - èŠ‚ç‚¹ diff            â”‚ â”‚
â”‚  â”‚                  â”‚          â”‚  - å¯è§†åŒ–é«˜äº®           â”‚ â”‚
â”‚  â”‚  [æ‹–æ‹½èŠ‚ç‚¹]      â”‚          â”‚  - å¹¶æ’å¯¹æ¯”             â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â”‚                                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  AI åŠ©æ‰‹ (OpenRouter + n8n-MCP)                             â”‚
â”‚  - å¯¹è¯å¼ç”Ÿæˆå·¥ä½œæµ                                         â”‚
â”‚  - ä¿®æ”¹å’Œä¼˜åŒ–èŠ‚ç‚¹                                           â”‚
â”‚  - ç”Ÿæˆåœºæ™¯å›¾ç‰‡                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  æ•°æ®å±‚ (Supabase)                                          â”‚
â”‚  - å­˜å‚¨å·¥ä½œæµ JSON                                          â”‚
â”‚  - ç‰ˆæœ¬å†å²ç®¡ç†                                             â”‚
â”‚  - ç”¨æˆ·è®¤è¯                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 æ ¸å¿ƒåŠŸèƒ½æ¨¡å—

#### 1. n8n ç¼–è¾‘å™¨é›†æˆ

**é€‰é¡¹ A: åµŒå…¥ n8n ç¼–è¾‘å™¨**
- ä½¿ç”¨ iframe åµŒå…¥ n8n å®ä¾‹
- ä¼˜ç‚¹ï¼šåŠŸèƒ½å®Œæ•´
- ç¼ºç‚¹ï¼šéœ€è¦éƒ¨ç½² n8n æœåŠ¡å™¨

**é€‰é¡¹ B: è‡ªç ”è½»é‡ç¼–è¾‘å™¨**
- ä½¿ç”¨ React Flow ç­‰å›¾å½¢åº“
- æ¨¡æ‹Ÿ n8n èŠ‚ç‚¹æ ·å¼
- ä¼˜ç‚¹ï¼šè½»é‡ã€å¯æ§
- ç¼ºç‚¹ï¼šåŠŸèƒ½å—é™

**é€‰é¡¹ C: ä½¿ç”¨ n8n-MCP çº¯ AI ç”Ÿæˆ** â­ æ¨è
- ç”¨æˆ·ç”¨è‡ªç„¶è¯­è¨€æè¿°æµç¨‹
- AI é€šè¿‡ n8n-MCP ç”Ÿæˆ JSON
- ä½¿ç”¨ N8N Viewer å¯è§†åŒ–
- ä¼˜ç‚¹ï¼šé›¶å­¦ä¹ æˆæœ¬ï¼Œæœ€ç®€å•
- ç¼ºç‚¹ï¼šä¾èµ– AI ç†è§£å‡†ç¡®æ€§

#### 2. ç‰ˆæœ¬å¯¹æ¯”é€»è¾‘

```typescript
// lib/workflow-diff.ts

export interface WorkflowDiff {
  addedNodes: Node[]      // æ–°å¢èŠ‚ç‚¹
  modifiedNodes: Node[]   // ä¿®æ”¹èŠ‚ç‚¹
  deletedNodes: Node[]    // åˆ é™¤èŠ‚ç‚¹
  addedConnections: Connection[]
  deletedConnections: Connection[]
}

export function compareWorkflows(
  oldWorkflow: WorkflowJSON,
  newWorkflow: WorkflowJSON
): WorkflowDiff {
  // 1. å¯¹æ¯”èŠ‚ç‚¹
  const oldNodeIds = new Set(oldWorkflow.nodes.map(n => n.id))
  const newNodeIds = new Set(newWorkflow.nodes.map(n => n.id))

  const addedNodes = newWorkflow.nodes.filter(n => !oldNodeIds.has(n.id))
  const deletedNodes = oldWorkflow.nodes.filter(n => !newNodeIds.has(n.id))

  const modifiedNodes = newWorkflow.nodes.filter(newNode => {
    const oldNode = oldWorkflow.nodes.find(n => n.id === newNode.id)
    return oldNode && !_.isEqual(oldNode, newNode)
  })

  // 2. å¯¹æ¯”è¿æ¥
  // ...ç±»ä¼¼é€»è¾‘

  return { addedNodes, modifiedNodes, deletedNodes, ... }
}
```

#### 3. å¯è§†åŒ–æ¸²æŸ“

ä½¿ç”¨ **React Flow** æ¸²æŸ“ n8n å·¥ä½œæµï¼š

```typescript
import ReactFlow from 'reactflow'

export function WorkflowViewer({ workflow, diff }: Props) {
  const nodes = workflow.nodes.map(node => ({
    id: node.id,
    type: node.type,
    data: { label: node.name },
    position: node.position,
    style: {
      // æ ¹æ® diff è®¾ç½®é¢œè‰²
      backgroundColor:
        diff.addedNodes.includes(node) ? '#22c55e' :  // ç»¿è‰²
        diff.modifiedNodes.includes(node) ? '#f59e0b' : // æ©™è‰²
        '#fff'
    }
  }))

  const edges = extractConnections(workflow.connections)

  return <ReactFlow nodes={nodes} edges={edges} />
}
```

#### 4. AI å·¥ä½œæµç”Ÿæˆï¼ˆn8n-MCPï¼‰

```typescript
// lib/ai-workflow-generator.ts

export async function generateWorkflow(
  description: string
): Promise<WorkflowJSON> {
  // è°ƒç”¨æ”¯æŒ n8n-MCP çš„ AI
  const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${API_KEY}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({
      model: 'anthropic/claude-3.5-sonnet',
      messages: [
        {
          role: 'system',
          content: 'You are an n8n workflow expert. Use MCP tools to create workflows.'
        },
        {
          role: 'user',
          content: `Create an n8n workflow for: ${description}`
        }
      ],
      // å¯ç”¨ MCP
      tools: [{ type: 'mcp', server: 'n8n-mcp' }]
    })
  })

  const result = await response.json()
  return result.workflow // n8n JSON æ ¼å¼
}
```

### 5.3 æ•°æ®åº“è¡¨ç»“æ„ï¼ˆæ‰©å±•ï¼‰

```sql
-- å·¥ä½œæµç‰ˆæœ¬è¡¨ï¼ˆæ›¿ä»£åŸæ¥çš„ versions è¡¨ï¼‰
create table workflow_versions (
  id uuid primary key default uuid_generate_v4(),
  project_id uuid references projects not null,
  version_number int not null,
  workflow_json jsonb not null,  -- å®Œæ•´çš„ n8n JSON
  description text,               -- ç‰ˆæœ¬æè¿°
  created_at timestamp default now()
);

-- å·¥ä½œæµå…ƒæ•°æ®
create table workflow_metadata (
  id uuid primary key default uuid_generate_v4(),
  version_id uuid references workflow_versions,
  node_count int,                 -- èŠ‚ç‚¹æ•°é‡
  connection_count int,           -- è¿æ¥æ•°é‡
  complexity_score int            -- å¤æ‚åº¦è¯„åˆ†
);
```

---

## å…­ã€å®æ–½å»ºè®®

### 6.1 MVP æ–¹æ¡ˆï¼ˆ2.5å°æ—¶ï¼‰â­ æ¨è

**æ ¸å¿ƒæ€è·¯**: ç”¨ AI ç”Ÿæˆå·¥ä½œæµ JSONï¼Œç”¨å¯è§†åŒ–å±•ç¤ºå’Œå¯¹æ¯”

```
ç”¨æˆ·è¾“å…¥éœ€æ±‚æè¿°
    â†“
AI (é€šè¿‡ n8n-MCP) ç”Ÿæˆ n8n JSON
    â†“
ä¿å­˜åˆ° Supabase (workflow_versions)
    â†“
ä½¿ç”¨ React Flow å¯è§†åŒ–æ¸²æŸ“
    â†“
å¯¹æ¯”ä¸¤ä¸ªç‰ˆæœ¬çš„ JSONï¼Œé«˜äº®å·®å¼‚
```

**åŠŸèƒ½æ¸…å•**:
1. âœ… ç”¨æˆ·è®¤è¯ï¼ˆSupabaseï¼‰
2. âœ… AI å¯¹è¯ç”Ÿæˆå·¥ä½œæµï¼ˆOpenRouter + n8n-MCPï¼‰
3. âœ… å·¥ä½œæµå¯è§†åŒ–ï¼ˆReact Flowï¼‰
4. âœ… ç‰ˆæœ¬å¯¹æ¯”ï¼ˆJSON diff + å¯è§†åŒ–é«˜äº®ï¼‰
5. âœ… ä¿å­˜/åŠ è½½ç‰ˆæœ¬ï¼ˆSupabaseï¼‰
6. âœ… ç”Ÿæˆåœºæ™¯å›¾ç‰‡ï¼ˆç°æœ‰åŠŸèƒ½ï¼‰

**æŠ€æœ¯æ ˆ**:
- Next.js + TypeScript
- Supabase (Auth + DB)
- OpenRouter (AI + n8n-MCP)
- React Flow (å¯è§†åŒ–)
- difflib.js (JSON å¯¹æ¯”)

**æ—¶é—´åˆ†é…**:
- Supabase è®¾ç½®: 10min
- å®‰è£…ä¾èµ–: 5min
- AI é›†æˆ (n8n-MCP): 30min â­ æ ¸å¿ƒ
- React Flow æ¸²æŸ“: 30min
- ç‰ˆæœ¬å¯¹æ¯”é€»è¾‘: 20min
- ä¿å­˜/åŠ è½½: 15min
- ç”¨æˆ·è®¤è¯: 15min
- éƒ¨ç½²: 15min
- æµ‹è¯•: 20min

### 6.2 æ··åˆæ–¹æ¡ˆï¼ˆ3å°æ—¶ï¼‰

**åŒæ—¶æ”¯æŒæ–‡æœ¬å’ŒèŠ‚ç‚¹ä¸¤ç§æ¨¡å¼**:

- ç”¨æˆ·é€‰æ‹©"æµç¨‹åŒ–éœ€æ±‚" â†’ n8n èŠ‚ç‚¹æ¨¡å¼
- ç”¨æˆ·é€‰æ‹©"æè¿°æ€§éœ€æ±‚" â†’ æ–‡æœ¬æ¨¡å¼

ä¼˜ç‚¹ï¼šé€‚ç”¨èŒƒå›´æ›´å¹¿
ç¼ºç‚¹ï¼šå¤æ‚åº¦æå‡

### 6.3 è¿›é˜¶æ–¹æ¡ˆï¼ˆæœªæ¥è¿­ä»£ï¼‰

1. **åµŒå…¥çœŸå® n8n ç¼–è¾‘å™¨**
   - ç”¨æˆ·å¯æ‰‹åŠ¨ç¼–è¾‘èŠ‚ç‚¹
   - å®Œæ•´çš„ n8n åŠŸèƒ½

2. **å·¥ä½œæµæ‰§è¡Œ**
   - åœ¨å¹³å°å†…ç›´æ¥è¿è¡Œå·¥ä½œæµ
   - æµ‹è¯• PRD é€»è¾‘

3. **å¤šäººåä½œç¼–è¾‘**
   - å®æ—¶åŒæ­¥èŠ‚ç‚¹ä¿®æ”¹
   - å†²çªè§£å†³

---

## ä¸ƒã€é£é™©å’ŒæŒ‘æˆ˜

### 7.1 æŠ€æœ¯é£é™©

| é£é™© | å½±å“ | ç¼“è§£æªæ–½ |
|------|------|----------|
| n8n-MCP ç¨³å®šæ€§ | AI ç”Ÿæˆè´¨é‡ | äººå·¥å®¡æ ¸ + æ”¯æŒæ‰‹åŠ¨ç¼–è¾‘ |
| React Flow æ€§èƒ½ | å¤§å‹å·¥ä½œæµå¡é¡¿ | è™šæ‹ŸåŒ–æ¸²æŸ“ + åˆ†é¡µåŠ è½½ |
| JSON å¤æ‚åº¦ | å¯¹æ¯”ç®—æ³•å¤æ‚ | ä½¿ç”¨æˆç†Ÿåº“ï¼ˆjsondiffpatchï¼‰ |

### 7.2 ç”¨æˆ·ä½“éªŒé£é™©

| é£é™© | å½±å“ | ç¼“è§£æªæ–½ |
|------|------|----------|
| å­¦ä¹ æˆæœ¬ | ç”¨æˆ·ä¸ç†è§£èŠ‚ç‚¹æ¦‚å¿µ | æä¾›æ¨¡æ¿ + æ•™ç¨‹ + AI è¾…åŠ© |
| é€‚ç”¨èŒƒå›´ | éƒ¨åˆ†éœ€æ±‚æ— æ³•è¡¨è¾¾ | æä¾›æ–‡æœ¬æ¨¡å¼ä½œä¸ºè¡¥å…… |
| AI ç†è§£åå·® | ç”Ÿæˆçš„å·¥ä½œæµä¸å‡†ç¡® | æ”¯æŒè¿­ä»£ä¿®æ­£ + ç”¨æˆ·åé¦ˆ |

---

## å…«ã€æœ€ç»ˆå»ºè®®

### ğŸ¯ ç»“è®ºï¼š**å¼ºçƒˆæ¨èé‡‡ç”¨ n8n èŠ‚ç‚¹æ–¹æ¡ˆ**

**ç†ç”±**:
1. âœ… **åˆ›æ–°æ€§**: å¸‚é¢ä¸Šæ²¡æœ‰ç±»ä¼¼äº§å“ï¼Œå·®å¼‚åŒ–ç«äº‰
2. âœ… **æ˜“ç”¨æ€§**: æ¯”å†™ PRD æ–‡æ¡£ç®€å• 10 å€
3. âœ… **å¯è§†åŒ–**: æ™®é€šäººä¹Ÿèƒ½çœ‹æ‡‚æµç¨‹å›¾
4. âœ… **å¯æ‰§è¡Œ**: PRD å˜æˆå¯è¿è¡Œçš„åŸå‹
5. âœ… **AI åŸç”Ÿ**: n8n-MCP å¤©ç„¶æ”¯æŒï¼Œå¼€å‘é«˜æ•ˆ

### ğŸ“‹ å®æ–½è·¯å¾„

**Phase 1 (MVP - 2.5å°æ—¶)**:
- AI ç”Ÿæˆ n8n JSON
- React Flow å¯è§†åŒ–
- ç‰ˆæœ¬å¯¹æ¯”é«˜äº®
- Supabase å­˜å‚¨
- éƒ¨ç½²ä¸Šçº¿

**Phase 2 (è¿­ä»£ - 1å‘¨)**:
- ä¼˜åŒ– AI ç”Ÿæˆè´¨é‡
- å¢åŠ èŠ‚ç‚¹æ¨¡æ¿åº“
- æ”¯æŒæ‰‹åŠ¨å¾®è°ƒèŠ‚ç‚¹
- å¢å¼ºå¯¹æ¯”åŠŸèƒ½

**Phase 3 (è¿›é˜¶ - 2å‘¨)**:
- åµŒå…¥çœŸå® n8n ç¼–è¾‘å™¨
- æ”¯æŒå·¥ä½œæµæ‰§è¡Œ
- å¤šäººåä½œ
- å¯¼å‡ºåˆ° n8n å¹³å°

### ğŸš€ ç«‹å³è¡ŒåŠ¨

å»ºè®®ä¿®æ”¹åŸè®¾è®¡æ–‡æ¡£ï¼Œå°†æ ¸å¿ƒä»"æ–‡æœ¬ PRD å¯¹æ¯”"æ”¹ä¸º"n8n å·¥ä½œæµå¯¹æ¯”"ã€‚

---

**å‚è€ƒèµ„æ–™**:
- n8n-MCP: https://www.n8n-mcp.com/
- n8n Docs: https://docs.n8n.io/
- React Flow: https://reactflow.dev/
- N8N Viewer: https://n8nviewer.com/
